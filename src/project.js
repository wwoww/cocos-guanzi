window.__require=function t(e,n,i){function a(r,c){if(!n[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var s="function"==typeof __require&&__require;if(!c&&s)return s(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+r+"'")}}var d=n[r]={exports:{}};e[r][0].call(d.exports,function(t){return a(e[r][1][t]||t)},d,d.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({Game:[function(t,e,n){"use strict";cc._RF.push(e,"dfb9f7ceeRIbqNPU9EwrZxr","Game"),cc.Class({extends:cc.Component,properties:{prefabResult:cc.Prefab,txtScore:cc.Label},start:function(){this.init()},init:function(){this.score=0},showResult:function(t){var e=this.node.getChildByName("result");null==e&&(e=cc.instantiate(this.prefabResult),this.node.addChild(e,10,"result"),e.x=0,e.y=0),e.getComponent("Result").setScore(t)},hideResult:function(){var t=this.node.getChildByName("result");null!=t&&t.removeFromParent()},setScore:function(t){this.txtScore.string=t,this.score=t},getScore:function(){return cc.log("get",this.score),this.score},settle:function(){this.showResult(this.score)}}),cc._RF.pop()},{}],Ladder:[function(t,e,n){"use strict";cc._RF.push(e,"e18cbsdseBBxq1e+H6dDHRS","Ladder"),cc.Class({extends:cc.Component,properties:{maxLength:{default:200,displayName:"\u6700\u5927\u9ad8\u5ea6",tooltip:"\u68af\u5b50\u80fd\u5230\u7684\u6700\u5927\u9ad8\u5ea6"},minLength:{default:10,displayName:"\u6700\u4f4e\u9ad8\u5ea6",tooltip:"\u68af\u5b50\u80fd\u5230\u7684\u6700\u4f4e\u9ad8\u5ea6"},ladderWidth:{default:6,displayName:"\u68af\u5b50\u5bbd\u5ea6"},ladderSpriteFrame:{default:null,type:cc.SpriteFrame,tooltip:"\u7ed8\u5236\u68af\u5b50\u7528"},putSpeed:{default:.5,displayName:"\u653e\u68af\u5b50\u901f\u5ea6",tooltip:"\u503c\u8d8a\u5927\u8d8a\u6162"},player:{default:null,type:cc.Node,displayName:"\u4eba\u7269"},standNode:{default:null,type:cc.Node,tooltip:"\u4eba\u7269\u6240\u5728\u5730"}},onLoad:function(){this.player.setParent(this.standNode),this.player.getComponent("Player").moveToRight(),this.putLadder()},putLadder:function(){var t=this.standNode;if(null==t.getChildByName("ladder")){var e=new cc.Node("ladder"),n=e.addComponent(cc.Sprite);n.spriteFrame=this.ladderSpriteFrame,n.type=cc.Sprite.Type.FILLED,n.fillType=cc.Sprite.FillType.VERTICAL,e.anchorX=0,e.anchorY=0,e.width=this.ladderWidth,e.height=this.maxLength,e.status=1,e.x=t.width*(1-t.anchorX),e.y=t.height*(1-t.anchorY)-e.height*e.anchorY,t.addChild(e)}},changeLadderPosition:function(){if(null!=this.standNode){var t=this.standNode,e=this.standNode.getChildByName("ladder");e.x=t.width*(1-t.anchorX)-e.width*(1-e.anchorX),e.y=t.height*(1-t.anchorY)-e.height*e.anchorY}},start:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){t.startPutLadder()}),this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.stopPutLadder()})},startPutLadder:function(){var t=this.standNode.getChildByName("ladder");if(null!=t&&1==t.status){var e=t.getComponent(cc.Sprite);if(null!=e){t.status=2;var n=cc.spawn(cc.delayTime(.02),cc.callFunc(function(){var n=e.fillRange;(n+=.05)<=1?e.fillRange=n:(e.fillRange=1,t.stopAllActions())}));e.fillRange=this.minLength/this.maxLength,t.runAction(n).repeatForever()}}},stopPutLadder:function(){var t=this.standNode.getChildByName("ladder");if(null!=t&&(2==t.status&&null!=t.getComponent(cc.Sprite))){t.stopAllActions(),t.status=3;var e=this,n=cc.sequence(cc.rotateBy(this.putSpeed,90),cc.callFunc(function(){do{if(null==e.player)break;var t=e.player.getComponent("Player");if(null==t)break;t.run({length:e.getRunLength(),onRunEnd:function(){e.check()}})}while(0)}));t.runAction(n)}},update:function(t){},getRunLength:function(){var t=this.standNode.getChildByName("ladder"),e=this.node.getComponent("LandFactory");if(null!=t&&null!=e){var n=e.lastLand,i=e.nextLand;if(null!=n&&null!=i){var a=n.x+n.width*(1-n.anchorX),o=i.x-i.width*i.anchorX-a,r=i.x+i.width*(1-i.anchorX)-a,c=t.height*t.getComponent(cc.Sprite).fillRange;return c>o&&c<r?r:c}}},check:function(){var t=this.node.getComponent("LandFactory");if(null!=t){var e=t.lastLand,n=t.nextLand,i=e.x+e.width*(1-e.anchorX),a=n.x-n.width*n.anchorX-i,o=n.x+n.width*(1-n.anchorX)-i;if(!(a<0||o<0||a>=o)){var r=this.standNode.getChildByName("ladder"),c=r.height*r.getComponent(cc.Sprite).fillRange;if(c>a&&c<o)this.calcScore(),this.player.setParent(t.nextLand),this.standNode=t.nextLand,this.putLadder(),this.player.getComponent("Player").moveToRight(),t.next();else{var l=this,s=cc.callFunc(function(){var t=l.player.getComponent("Player");null!=t?t.die({onFailEnd:function(){},onDieEnd:function(){l.onDeadCallback()}}):cc.log("js is null.")});r.runAction(cc.sequence(cc.rotateBy(.2,90),s))}}}},calcScore:function(){var t=this.node.getComponent("LandFactory"),e=t.lastLand,n=t.nextLand.x-e.x-(1-e.anchorX)*e.width,i=t.rewardWidth,a=n-Math.floor(i/2),o=n+Math.floor(i/2),r=this.standNode.getChildByName("ladder"),c=r.height*r.getComponent(cc.Sprite).fillRange,l=1;c>a&&c<o&&(l=2);var s=this.getComponent("Game");s.setScore(s.getScore()+l),this.player.getComponent("Player").playBingo(l)},onDeadCallback:function(){var t=this.getComponent("Game");null!=t&&t.settle()}}),cc._RF.pop()},{}],LandFactory:[function(t,e,n){"use strict";cc._RF.push(e,"8686fuEruhKGZnBpobfkkWy","LandFactory"),cc.Class({extends:cc.Component,properties:{totalHeight:{default:250,displayName:"\u603b\u9ad8\u5ea6",tooltip:"\u5360\u5c4f\u5e55\u9ad8\u5ea6\u767e\u5206\u6bd4%"},topHeight:{default:50,displayName:"\u4e0a\u5c42\u9ad8\u5ea6",tooltip:"\u5360\u603b\u9ad8\u5ea6\u767e\u5206\u6bd4%"},rewardWidth:{default:10,displayName:"\u5956\u52b1\u533a\u57df\u5927\u5c0f",tooltip:"\u7ea2\u8272\u90e8\u5206"},minDistance:{default:10,displayName:"\u6700\u5c0f\u95f4\u8ddd",tooltip:"\u6c34\u5e73\u7ebf\u4e24\u5757\u4e4b\u95f4\u6700\u5c0f\u95f4\u8ddd"},maxDistance:{default:200,displayName:"\u6700\u5927\u95f4\u8ddd",tooltip:"\u6c34\u5e73\u7ebf\u4e24\u5757\u4e4b\u95f4\u6700\u5927\u95f4\u8ddd"},minWidth:{default:10,displayName:"\u6700\u5c0f\u5bbd\u5ea6",tooltip:"\u5355\u5757\u6700\u5c0f\u5bbd\u5ea6"},maxWidth:{default:100,displayName:"\u6700\u5927\u5bbd\u5ea6",tooltip:"\u5355\u5757\u6700\u5927\u5bbd\u5ea6"},startOffset:{default:100,displayName:"\u8d77\u59cb\u8ddd\u79bb",tooltip:"\u4eba\u7269\u8d77\u59cb\u4f4d\u7f6e"},spGrass:{default:null,type:cc.Sprite,tooltip:"\u8349\u5730"},bgOffset:{default:640,displayName:"\u79fb\u52a8\u504f\u79fb\u91cf",tooltip:"\u9519\u4f4d\u79fb\u52a8\u6548\u679c"},parentNode:{default:null,type:cc.Node},spriteFrameDouble:{default:null,type:cc.SpriteFrame},startNode:{default:null,type:cc.Node},lastWidth:{default:0,visible:!1},lastLand:{default:null,type:cc.Node,visible:!1},nextWidth:{default:0,visible:!1},nextLand:{default:null,type:cc.Node,visible:!1},oldLand:{default:null,type:cc.Node,visible:!1}},onLoad:function(){this.initStartNode(),this.lastLand=this.startNode,this.lastWidth=this.startNode.width,this.nextWidth=this.startNode.width,this.lastLand.zIndex+=1;var t=this.boreLand();if(null!=t){var e=this.startOffset+this.generateDistance(this.lastWidth,t.width,this.maxDistance,this.minDistance);null!=e&&(t.x=e),this.nextLand=t}},initStartNode:function(){var t=0;t=this.totalHeight<=0?0:this.totalHeight>=100?cc.winSize.height:Math.floor(cc.winSize.height*this.totalHeight/100),this.startNode.x=this.startNode.anchorX*this.startNode.width,this.startNode.y=t-(1-this.startNode.anchorY)*this.startNode.height},next:function(){if(!(null!=this.lastLand&&this.lastLand.getNumberOfRunningActions()>0||null!=this.nextLand&&this.nextLand.getNumberOfRunningActions()>0)){var t=this.lastLand,e=this.nextLand,n=this.boreLand(),i=-(t.width/2+cc.winSize.width),a=this.startOffset-Math.floor(e.width/2),o=a+this.generateDistance(this.lastWidth,this.nextWidth,this.maxDistance,this.minDistance),r=.001*(t.x-i),c=.001*(e.x-a),l=.001*(n.x-o);t.runAction(cc.sequence(cc.moveTo(r,i,t.y),cc.removeSelf()));var s=!0,d=!0,h=this,u=function(){if(!s&&!d){var t=h.getComponent("Ladder");null!=t&&(t.standNode=e)}};e.runAction(cc.sequence(cc.moveTo(c,a,e.y),cc.callFunc(function(){s=!1,u()}))),n.runAction(cc.sequence(cc.moveTo(l,o,n.y),cc.callFunc(function(){d=!1,u()}))),this.oldLand=t,this.lastLand=e,this.nextLand=n,this.lastLand.zIndex+=1}},boreLand:function(){if(null!=this.parentNode){var t=this.generateLand();return this.parentNode.addChild(t),t.x=cc.winSize.width+t.width/2,t}return null},generateLand:function(){if(this.topHeight<0)return null;var t=this.generateLandWidth(this.nextWidth,this.minWidth,this.maxWidth,this.maxDistance,this.minDistance),e=this.getLandTotalHeight(),n=this.getLandTopHeight(e),i=new cc.Node;i.width=t,i.height=e,i.anchorX=.5,i.anchorY=0,i.y=0;var a=this.generateSprite("top",t,n,this.getTopSpriteFrame());if(a.node.anchorX=.5,a.node.anchorY=0,a.node.x=0,a.node.y=e-n,i.addChild(a.node),n<e){var o=this.generateSprite("bottom",t,e-n,this.getBottomSpriteFrame());o.node.anchorX=.5,o.node.anchorY=0,o.node.x=0,o.node.y=0,i.addChild(o.node)}if(null==this.spriteFrameDouble||this.rewardWidth<0)return null;var r=this.generateSprite("reward",this.rewardWidth,this.rewardWidth,this.spriteFrameDouble);return r.node.anchorX=.5,r.node.anchorY=1,r.node.x=0,r.node.y=e,i.addChild(r.node),this.lastWidth=this.nextWidth,this.nextWidth=t,i},getTopSpriteFrame:function(){var t=this.getComponent("Skin");return null!=t?t.getZhuziSpriteFrame():null},getBottomSpriteFrame:function(){var t=this.getComponent("Skin");return null!=t?t.getZhuziSpriteFrame():null},generateSprite:function(t,e,n,i){if(null==t||null==e||null==n||null==i)return null;var a=new cc.Node(t),o=a.addComponent(cc.Sprite);return o.spriteFrame=i,o.type=cc.Sprite.Type.SLICED,a.width=e,a.height=n,o},generateDistance:function(t,e,n,i){if(!(t<0||e<0||n<0)){var a=(t+e)/2+i;if(!(a>n)){var o=Math.random()*(n-a);return Math.floor(a)+Math.floor(o)}}},generateLandWidth:function(t,e,n,i,a){if(t<0||e<0||i<0||a<0)return 0;var o=2*Math.floor(i-t/2-a);o>n&&(o=n);var r=Math.random()*(o-e);return e+Math.floor(r)},getLandTotalHeight:function(){return this.totalHeight<=0?0:this.totalHeight>=100?cc.winSize.height:Math.floor(cc.winSize.height*this.totalHeight/100)},getLandTopHeight:function(t){return this.topHeight<=0?0:this.topHeight>=100?t:Math.floor(t*this.topHeight/100)},start:function(){}}),cc._RF.pop()},{}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"f6e54IEf5BG9KdIBAYjzvzD","Player"),cc.Class({extends:cc.Component,properties:{player:{default:null,type:cc.Sprite},runSpeed:{default:.002,displayName:"\u524d\u8fdb\u901f\u5ea6",tooltip:"\u503c\u8d8a\u5927\u8d8a\u6162"},fallSpeed:{default:.5,displayName:"\u4e0b\u843d\u901f\u5ea6",tooltip:"\u503c\u8d8a\u5927\u8d8a\u6162"},offset:{default:5,displayName:"\u504f\u79fb\u91cf",tooltip:"\u4eba\u7269\u53f3\u4fa7\u8ddd\u79bb\u6240\u5728\u5730\u5757\u53f3\u4fa7\u504f\u79fb\u91cf"},spriteFrameBingo1:cc.SpriteFrame,spriteFrameBingo2:cc.SpriteFrame},start:function(){},run:function(t){if(null!=this.player&&null!=t.length&&"number"==typeof t.length){var e=this.getComponent(cc.Animation),n=cc.moveBy(this.runSpeed*t.length,t.length,0),i=cc.spawn(n,cc.callFunc(function(){e.stop("Run"),e.playAdditive("Run")})),a=cc.callFunc(function(){e.stop(),null!=t.onRunEnd&&"function"==typeof t.onRunEnd&&t.onRunEnd()}),o=cc.sequence(i,a);this.player.node.runAction(o)}},die:function(t){if(null!=this.player){var e=this.player.node.convertToWorldSpace(this.player.node.position).y+this.player.node.height,n=cc.moveBy(this.fallSpeed*e,0,-e),i=cc.callFunc(function(){null!=t&&null!=t.onFailEnd&&"function"==typeof t.onFailEnd&&t.onFailEnd()}),a=cc.callFunc(function(){null!=t&&null!=t.onDieEnd&&"function"==typeof t.onDieEnd&&t.onDieEnd()}),o=cc.sequence(n,i,a);this.player.node.runAction(o)}},moveToRight:function(){var t=this.node.getParent();this.node.x=t.width*(1-t.anchorX)-(1-this.node.anchorX)*this.node.width-this.offset,this.node.y=t.height*(1-t.anchorY)+this.node.anchorY*this.node.height},playBingo:function(t){if(null!=this.spriteFrameBingo1&&null!=this.spriteFrameBingo2){var e=new cc.Node("bingo"),n=e.addComponent(cc.Sprite);n.spriteFrame=1==t?this.spriteFrameBingo1:this.spriteFrameBingo2,e.anchorX=.5,e.anchorY=.5,e.x=0,e.y=0,this.node.addChild(e);var i=cc.moveBy(.5,0,100);e.runAction(cc.sequence(i,cc.removeSelf()))}}}),cc._RF.pop()},{}],Result:[function(t,e,n){"use strict";cc._RF.push(e,"8df9bVHrOJDtowyTAp8xYdR","Result"),cc.Class({extends:cc.Component,properties:{txtScore:cc.Label},onLoad:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation(),t.node.removeFromParent(),cc.director.loadScene("game")})},setScore:function(t){null!=this.txtScore&&(null!=t&&"number"==typeof t||(t=0),this.txtScore.string=t)},start:function(){}}),cc._RF.pop()},{}],Skin:[function(t,e,n){"use strict";cc._RF.push(e,"366f2s9k4JMFLRkIl1VXqXD","Skin"),cc.Class({extends:cc.Component,properties:{spriteFrameZhuzi:[cc.SpriteFrame],index:{default:-1,visible:!1}},start:function(){var t=this.getComponent("Ladder");null!=t&&t.changeLadderPosition()},randomNum:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},getZhuziSpriteFrame:function(){return this.spriteFrameZhuzi.length<=0?null:((this.index<0||this.index>=this.spriteFrameZhuzi.length)&&(this.index=this.randomNum(0,2)),this.spriteFrameZhuzi[this.index])}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e,n){"use strict";cc._RF.push(e,"3b77eYyQVdJKLge9BwgCnIx","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["Game","Ladder","LandFactory","Player","Skin","Result","use_v2.0.x_cc.Toggle_event"]);